# Testing 

## Table of Contents
- [Testing User Stories](#testing-user-stories-from-the-user-experience-ux-section)
- [Code Validation](#code-validation)
- [Functionality Testing](#functionality-testing)
- [Performance Testing](#performance-testing)
- [Bugs](#bugs)

## Testing User Stories from the User Experience (UX) Section

- Epic: Viewing and Navigation

    - [x] [#1](https://github.com/sejungkwak/cogito-books/issues/1) As a first-time visitor, I want to know what the shop sells immediately so that I can decide whether I will browse further.

        ![Intuitive landing page](user_story_testing/user_story_1.png)

    <br>

    - [x] [#2](https://github.com/sejungkwak/cogito-books/issues/2) As a first-time visitor, I want to navigate pages easily so that I can find information I’m looking for.

        ![Easy to navigate](user_story_testing/user_story_2.png)


    - [x] [#3](https://github.com/sejungkwak/cogito-books/issues/3) As a shopper, I want to know if the shop is trustworthy so that I can make a purchase without any worry.

        : A user can view the store policies and visit its social media account to make sure it is trustworthy.

        ![Trustworthy site](user_story_testing/user_story_3.png)

    - [x] [#46](https://github.com/sejungkwak/cogito-books/issues/46) As a shopper, I want to view a list of all books so that I can easily select some to purchase.

        ![View a list of all books](user_story_testing/user_story_46.png)

    - [x] [#47](https://github.com/sejungkwak/cogito-books/issues/47) As a shopper, I want to quickly identify deals, bestsellers and new releases so that I can easily find interesting books.

        ![View categorised books](user_story_testing/user_story_47.png)

    - [x] [#48](https://github.com/sejungkwak/cogito-books/issues/48) As a shopper, I want to view individual book details so that I can decide whether I want to buy the book.

        ![View book details](user_story_testing/user_story_48.png)

- Epic: Registration and User Accounts

    - [x] [#4](https://github.com/sejungkwak/cogito-books/issues/4) As a site user, I want to sign up so that I can save and view my details.

        ![Sign up page](user_story_testing/user_story_4.png)

    - [x] [#5](https://github.com/sejungkwak/cogito-books/issues/5) As a site user, I want to sign in and sign out of my account with my credentials so that I can keep my account secure.

        ![Sign in page](user_story_testing/user_story_5.png)

    - [x] [#6](https://github.com/sejungkwak/cogito-books/issues/6) As a site user, I want to update my password so that I can keep my account secure.

        ![Password update](user_story_testing/user_story_6.png)


    - [x] [#7](https://github.com/sejungkwak/cogito-books/issues/7) As a site user, I want to reset my password so that I can access my account even if I forget my password.

        ![Reset password](user_story_testing/user_story_7.png)

    - [x] [#8](https://github.com/sejungkwak/cogito-books/issues/8) As a site user, I want to save my delivery information so that I don’t have to fill in the form every time I make a purchase.

        ![Save delivery information](user_story_testing/user_story_8.png)

    - [x] [#9](https://github.com/sejungkwak/cogito-books/issues/9) As a site user, I want to update my delivery information so that I can keep my details up to date.

        ![Update delivery information](user_story_testing/user_story_9.png)

    - [x] [#10](https://github.com/sejungkwak/cogito-books/issues/10) As a site user, I want to have a personalised user profile so that I can view my loyalty points and order history.

        ![Personalised user profile](user_story_testing/user_story_10.png)

    - [x] [#11](https://github.com/sejungkwak/cogito-books/issues/11) As a site user, I want to add books to my wishlist so that I can purchase them at a later time.

        ![Wishlist](user_story_testing/user_story_11.png)

    - [x] [#12](https://github.com/sejungkwak/cogito-books/issues/12) As a site user, I want to sign up for a newsletter so that I can receive regular updates about new books and offers.

        ![Newsletter sign up](user_story_testing/user_story_12.png)

- Epic: Sorting and Searching

    - [x] [#13](https://github.com/sejungkwak/cogito-books/issues/13) As a shopper, I want to sort all the available books by publishing date so that I can easily identify newly released books.

        ![Sorting all books](user_story_testing/user_story_13.png)

    - [x] [#14](https://github.com/sejungkwak/cogito-books/issues/14) As a shopper, I want to sort sci-fi books by user ratings so that I can easily identify the best rated books in sci-fi.

        ![Sorting specific category](user_story_testing/user_story_14.png)

    - [x] [#15](https://github.com/sejungkwak/cogito-books/issues/15) As a shopper, I want to search for a book by title so that I can easily find a book I’d like to purchase.

        ![Search](user_story_testing/user_story_15.png)

- Epic: Book Reviews

    - [x] [#16](https://github.com/sejungkwak/cogito-books/issues/16) As a shopper, I want to view reviews of a book so that I can check what other people think of it.

        ![View reviews](user_story_testing/user_story_16.png)

    - [x] [#17](https://github.com/sejungkwak/cogito-books/issues/17) As a shopper, I want to add a review so that I can share my thoughts.

        ![Add review](user_story_testing/user_story_17.png)

    - [x] [#18](https://github.com/sejungkwak/cogito-books/issues/18) As a shopper, I want to leave a rating without writing a review so that I can leave my opinion anonymously. 

        : A user can leave a rating anonymously.

    - [x] [#19](https://github.com/sejungkwak/cogito-books/issues/19) As a shopper, I want to update my review so that I can change any incorrect information.

       ![Update review](user_story_testing/user_story_19.png)

    - [x] [#20](https://github.com/sejungkwak/cogito-books/issues/20) As a shopper, I want to remove my review so that I can delete an invalid or irrelevant review.

        ![Update review](user_story_testing/user_story_20.png)

- Epic: Purchasing and Checkout

    - [x] [#21](https://github.com/sejungkwak/cogito-books/issues/21) As a shopper, I want to add books to my basket while viewing multiple books at a time so that I can make my purchase as quickly and easily as possible.

        ![Add to basket](user_story_testing/user_story_21.png)

    - [x] [#22](https://github.com/sejungkwak/cogito-books/issues/22) As a shopper, I want to view items in my basket to be purchased so that I can identify the total cost of my purchase and all items I will receive.

        ![View basket](user_story_testing/user_story_22.png)

    - [x] [#23](https://github.com/sejungkwak/cogito-books/issues/23) As a shopper, I want to remove or adjust the quantity of individual items in my basket so that I can easily make changes to my purchase before checkout.

        ![Adjust basket](user_story_testing/user_story_23.png)

    - [x] [#24](https://github.com/sejungkwak/cogito-books/issues/24) As a shopper, I want to easily enter my payment information so that I can check out quickly and with little hassle.

        ![Quick payment system](user_story_testing/user_story_24.png)

    - [x] [#25](https://github.com/sejungkwak/cogito-books/issues/25) As a shopper, I want to collect loyalty points so that I can use it to purchase books.

        ![Collect Loyalty points](user_story_testing/user_story_25.png)

    - [x] [#26](https://github.com/sejungkwak/cogito-books/issues/26) As a shopper, I want to feel my personal and payment information are safe and secure so that I can confidently provide the needed information to make a purchase.

        - I opted to use _Stripe_ for secure checkout.


    - [x] [#27](https://github.com/sejungkwak/cogito-books/issues/27) As a shopper, I want to view an order confirmation after checkout so that I can verify that I haven't made any mistakes.

        ![Order confirmation page](user_story_testing/user_story_27.png)

    - [x] [#28](https://github.com/sejungkwak/cogito-books/issues/28) As a shopper, I want to receive an email confirmation after checking out so that I can keep it as an invoice of what I've purchased for my records.

        ![Order confirmation email](user_story_testing/user_story_28.png)

- Epic: Help Centre

    - [x] [#29](https://github.com/sejungkwak/cogito-books/issues/29) As a shopper, I want to see FAQs so that I don’t have to contact the store and wait for them to respond.

        ![FAQs](user_story_testing/user_story_29.png)

    - [x] [#30](https://github.com/sejungkwak/cogito-books/issues/30) As a shopper, I want to contact the store so that I can receive answers to my queries before purchase.

        ![Contact Store](user_story_testing/user_story_30.png)


    [ ] [#31](https://github.com/sejungkwak/cogito-books/issues/31) As a shopper, I want to receive notification via email the store answers my queries so that I can conveniently check it.

    : This feature has not been implemented as I prioritised each story using MoSCoW method, excluded `won't have` stories.

    - [x] [#32](https://github.com/sejungkwak/cogito-books/issues/32) As a store owner, I want to receive notifications upon a shopper’s contact so that I can reply in a timely manner.

        : It is partially fulfilled as _Google_ domain users cannot change the sender's email address. Added the user's email address to the body.

        ![User Contact Notification](user_story_testing/user_story_32.png)

- Epic: Admin and Store Management

    - [x] [#33](https://github.com/sejungkwak/cogito-books/issues/33) As a store owner, I want to add new products to my store so that I can ensure there is always something of interest to new and existing shoppers.

        ![Add a book](user_story_testing/user_story_33.png)

    - [x] [#34](https://github.com/sejungkwak/cogito-books/issues/34) As a store owner, I want to update product details such as prices, description, images and so on so that I can keep the product details up to date.

        ![Update a book](user_story_testing/user_story_34.png)

    - [x] [#35](https://github.com/sejungkwak/cogito-books/issues/35) As a store owner, I want to delete a product so that I can remove items that are no longer for sale.

        ![Delete a book](user_story_testing/user_story_35.png)

[Back To **Table of Contents**](#table-of-contents)

<br>

## Code Validation

- [HTML Validation](#html-validation)
- [CSS Validation](#css-validation)
- [JS Validation](#js-validation)
- [Python Validation](#python-validation)

### HTML Validation

No errors or warnings were found when passing through the [W3C Markup Validator](https://validator.w3.org/).

- Homepage

    ![HTML Homepage Validation](code_validation/html_home.png)

- Book list page

    ![HTML Book list page validation](code_validation/html_book_list.png)

- Book detail page

    ![HTML Book detail page validation](code_validation/html_book_detail.png)

- Add a book page

    ![HTML Add a book page validation](code_validation/html_add_book.png)

- Edit book page

    ![HTML Edit book page Validation](code_validation/html_edit_book.png)

- Delete book page

    ![HTML Delete book page validation](code_validation/html_delete_book.png)

- Add book of the month page

    ![HTML Add book of the month page Validation](code_validation/html_add_book_of_the_month.png)

- Basket page

    ![HTML Basket page validation](code_validation/html_basket.png)

- Checkout page

    ![HTML Checkout page validation](code_validation/html_checkout.png)

- Checkout success page

    ![HTML Checkout success page validation](code_validation/html_checkout_success.png)

- Account detail page

    ![HTML Account detail page validation](code_validation/html_account_detail.png)

- Order history page

    ![HTML Order history page Validation](code_validation/html_order_history.png)

- Wishlist page

    ![HTML Wishlist page Validation](code_validation/html_wishlist.png)

- Contact Us page

    ![HTML Contact Us page validation](code_validation/html_contact_us.png)

- FAQs page

    ![HTML FAQs page Validation](code_validation/html_faq.png)

- Privacy Policy page

    ![HTML Privacy Policy page Validation](code_validation/html_privacy_policy.png)

- Terms and Conditions page

    ![HTML  Validation](code_validation/html_terms_conditions.png)

### CSS Validation

No errors were found when passing through the [W3C CSS Validator](https://jigsaw.w3.org/css-validator/). There are warnings related to the Bootstrap code.

![CSS Validation](code_validation/css_validation.png)

### JS Validation

No errors or warnings were found when passing through [JSHint](https://jshint.com/).

- script.js

    ![JS script.js Validation](code_validation/js_base_script.png)

- carousel.js in the home app

    ![JS script.js Validation](code_validation/js_home-carousel.png)

- sort_option.js in the books app

    ![JS sort_option.js Validation](code_validation/js_book-sort_option.png)

- truncate_toggler.js in the books app

    ![JS truncate_toggler.js Validation](code_validation/js_book-truncate_toggler.png)

- qty_input.js in the books app

    ![JS qty_input.js Validation](code_validation/js_books-qty_input.png)

- point_redemption.js in the checkout page

    ![JS point_redemption.js Validation](code_validation/js_checkout-point_redemption.png)

- stripe.js in the checkout app

    ![JS stripe.js Validation](code_validation/js_checkout-stripe.png)

### Python Validation

- [pycodestyle](https://pypi.org/project/pycodestyle/) was utilised for PEP8 validation. No errors present. There are 5 line-length related issues remaining. As these are from the Django's configuration, I have left them as it is.

[Back To **Table of Contents**](#table-of-contents)

<br>

## Functionality Testing

- I have tested the site's functionality manually.
- During the tests, I found a bug where the signed-in user's review did not display. I fixed the issue.
- All the tests passed.
- Please refer to [this link](https://docs.google.com/spreadsheets/d/1JQKwA0J5oYXYqyHDLh_UMl8mF6JbQoMZH-21wcIxDHc/edit#gid=1491505462) for more details.

[Back To **Table of Contents**](#table-of-contents)

<br>

## Performance Testing

- I have measured the performance, accessibility, best practices and SEO using [Lighthouse](https://developers.google.com/web/tools/lighthouse) in Chrome DevTools in incognito mode.

    - Desktop report

        ![Lighthouse testing report](lighthouse_desktop.png)

    - Mobile report

        ![Lighthouse testing report](lighthouse_mobile.png)

    - As shown in the screenshot above, the report indicated high quality in all areas for desktop and mobile with a slight issue with performance on mobile devices. The analysis indicated that the unused JavaScript code from _Stripe_ and use of HTTP/1 (_AWS_) caused the lower result. However, as these services are not replaceable at this point and the score is not terrible, I have decided not to pursue any further changes.

[Back To **Table of Contents**](#table-of-contents)

<br>

# Bugs

## Fixed bugs

### Always saving a user’s delivery information
- Issue: User input (delivery address) on the checkout page was always saved to the profile default even when “Save this delivery information to my profile” was unchecked.
- Reason: I used an incorrect JQuery method which always returned true if the attribute `checked` is set to true in HTML.
- Fix: Instead of checking for the boolean value of the attribute, check for the status of the checkbox using JQuery method `.is()`.
- Commit: 6f32560

### `Userpassestestmixin` not working
- Issue: test_func() did not take effect with the CreateView and UpdateView.
- Reason: The order of arguments was incorrect.
- Fix: Moved `Userpassestestmixin` before the views.
- Commit: 2c4dea1

### Review not showing
- Issue: The signed-in user's own review was not visible.
- Reason: The position of an if block was incorrect in the template.
- Fix: Moved the if statement in the template.
- Commit: 9c03946

### Responsive menu container not closing correctly.
- Issue: The collapsible menu container did not close when another element was clicked.
- Reason: Mix of _Bootstrap_ nav and dropdown components caused the issue.
- Fix: Added JS code to check what the click event target is and change the menu visibility status accordingly.
- Commit: 2dc4223

### Homepage carousel button not working
- Issue: The buttons for the carousel did not work properly - Clicking __bestseller__ buttons made the __new releases__ section move.
- Reason: The same buttons were used for the both bestsellers and new releases sections. Bootstrap `data-bs-target` was pointing at the __new releases__ id.
- Fix: Added buttons to each section.
- Commit: 611d7a4

### Phone number field showing a string ‘IE’
- Issue: The phone number field’s default value is displayed in both prefix and suffix.
- Reason: I was not able to identify the exact cause of this issue. However, I assumed it was related to the third-party package `django-phonenumber-field` that I used for the phone number validation. I removed the default value from the model and ‘IE’ does not show in the field any more.
- Fix: Removed the default value from the model.
- Commit: 984a172

## Known bugs

### Email sender not correct
- Issue: A user’s email input value from the contact us form does not reflect the user email when sending an email to me via the form. The both the sender and receiver are me.
- Reason: Not changing FROM header is a _GMail_ restriction. The solution of the issue would be to use another SMTP service or _Google_’ email alias. Both options are not applicable to me at the moment as I need an actual business domain. (Refer: https://stackoverflow.com/questions/6803009 and https://stackoverflow.com/questions/24654947)
- Change: I have added the user’s email address to the body with the original content. That way, the admin can have an email address to reply to. Alternatively, an admin user can view all the contacts on the admin site.

[Back To **Table of Contents**](#table-of-contents)

<br>